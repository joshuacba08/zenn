---
title: "Configurando un proyecto de React para producci칩n"
emoji: "游부"
type: "tech"
topics:
  ["React", "Vite", "TypeScript", "ESLint", "Prettier", "Husky", "Commitlint"]
published: true
---

# Configurando un proyecto de React para producci칩n

## Introducci칩n

Internet est치 lleno de tutoriales sobre c칩mo iniciar un proyecto web con React, sin embargo la mayor칤a de estos tutoriales son para proyectos peque침os o de prueba. En este tutorial, aprender치s c칩mo las empresas reales configuran sus proyectos de React para producci칩n utilizando las mejores pr치cticas.

## Requerimientos t칠cnicos

Para seguir este art칤culo, necesitar치s tener instalado las siguientes tecnolog칤as:

- Node.js V20.10.0 o superior
- Git v2.43.0 o superior
- Visual Studio Code v1.94.0 o superior
- pnpm

Estas son las versiones que he utilizado para escribir este art칤culo, pero es posible que funcione con versiones anteriores no muy antiguas o superiores.

## 쯇or qu칠 pnpm?

Quiz치s la t칤pica frase que oir치s decir a la mayor칤a de los desarrolladores que usamos pnpm es: "pnpm es m치s r치pido que npm y yarn". Pero en mi experiencia trabajando en la industria, la raz칩n m치s importante para usar pnpm es que este instala las dependencias de forma plana, lo que significa que no instala m칰ltiples versiones de la misma dependencia. Esto ahorra espacio en disco y reduce el tiempo de instalaci칩n de las dependencias. Adem치s, evita problemas de compatibilidad entre las dependencias.

## Creando un nuevo proyecto con Vite

Vite es un nuevo bundler que ha ganado mucha popularidad en la comunidad de React. Vite es mucho m치s r치pido que Create React App y es compatible con TypeScript de forma nativa. Para crear un nuevo proyecto con Vite, simplemente ejecuta el siguiente comando:

```bash
pnpm create vite
```

Veremos las siguientes opciones:

- **Project name**: Nombre del proyecto, para este caso, el proyecto se llamar치 `react-real-world`.
- **Select a framework**: Selecciona React.
- **Select a variant**: Selecciona React con TypeScript.

Una vez que hayas seleccionado todas las opciones, Vite crear치 un nuevo proyecto de React con TypeScript.

Acto seguido, ejecuta los siguientes comandos para instalar las dependencias necesarias:

```bash
cd react-real-world
pnpm install
```

Tambi칠n abriremos el proyecto en Visual Studio Code:

```bash
code .
```

## React con SWC o Babel

Vite es compatible con SWC y Babel. SWC es un compilador de JavaScript extremadamente r치pido que es compatible con la mayor칤a de las caracter칤sticas de Babel. Sin embargo, Babel es m치s popular y tiene una comunidad m치s grande.

En lineas generales, los par치metros m치s importantes para elegir entre SWC y Babel son:

- **Velocidad**: SWC es mucho m치s r치pido que Babel.
- **Compatibilidad**: Babel es m치s compatible con las 칰ltimas caracter칤sticas de JavaScript.
- **Comunidad**: Babel tiene una comunidad m치s grande y es m치s popular.

Si tu aplicaci칩n ser치 muy grande y compleja y necesitas una velocidad de compilaci칩n muy r치pida en producci칩n, te recomiendo que uses SWC. Si tu aplicaci칩n es peque침a o mediana y necesitas una compatibilidad m치xima con las 칰ltimas caracter칤sticas de JavaScript, te recomiendo que uses Babel.

En todo caso, ser칤a mejor iniciar el proyecto con babel, osea no seleccionar SWC en la creaci칩n del proyecto, y luego cambiar a SWC si es necesario, los pasos para hacerlo son muy sencillos.

## Configurando ESLint y Prettier con TypeScript para aplicar las mejores pr치cticas

Ahora que hemos creado nuestro proyecto de React con TypeScript, es hora de configurar ESLint y Prettier para aplicar las mejores pr치cticas de codificaci칩n. Para ello justificaremos ambas herramientas cuando las estemos configurando.

Antes que nada vamos a instalar las dependencias necesarias:

```bash
pnpm install --save-dev prettier eslint eslint-plugin-react eslint-config-prettier eslint-plugin-jsx-a11y @typescript-eslint/parser @typescript-eslint/eslint-plugin
```

Pnpm instalar치 lo siguiente:

- **prettier**: Herramienta de formateo de c칩digo.
- **eslint**: Herramienta de an치lisis de c칩digo.
- **eslint-plugin-react**: Plugin de ESLint para React.
- **eslint-config-prettier**: Desactiva las reglas de ESLint que pueden entrar en conflicto con Prettier.
- **eslint-plugin-jsx-a11y**: Plugin de ESLint para accesibilidad en JSX.
- **@typescript-eslint/parser**: Parser de TypeScript para ESLint.
- **@typescript-eslint/eslint-plugin**: Plugin de ESLint para TypeScript.

> El comando `--save-dev` instala las dependencias como dependencias de desarrollo, lo que significa que no se instalar치n en producci칩n. Esto es obligatorio ya que de lo contrario las dependencias se instalar치n en producci칩n y aumentar치n el tama침o de la aplicaci칩n.

### Configurando Prettier

Prettier es una herramienta de formateo de c칩digo que te permite formatear tu c칩digo autom치ticamente. La motivaci칩n detr치s de Prettier es que no deber칤as perder tiempo formateando tu c칩digo manualmente, sino que deber칤as dejar que Prettier lo haga por ti autom치ticamente. De esta forma, todos los miembros del equipo de desarrollo seguir치n el mismo estilo de codificaci칩n.

Para configurar Prettier, crearemos un archivo llamdo `.prettierrc.json` en la ra칤z del proyecto con el siguiente contenido:

```json
{
  "trailingComma": "all",
  "tabWidth": 2,
  "printWidth": 80,
  "semi": false,
  "singleQuote": true,
  "jsxSingleQuote": true
}
```

#### Configurando la extensi칩n de Prettier en Visual Studio Code

Para que Visual Studio Code formatee autom치ticamente tu c칩digo con Prettier, necesitas instalar la extensi칩n de Prettier. Para ello, abre Visual Studio Code y busca la extensi칩n de Prettier en el Marketplace. Una vez que la hayas instalado, Visual Studio Code formatear치 autom치ticamente tu c칩digo con Prettier cada vez que guardes un archivo.

![1731513319811](image/7ee9d46e796ce9/1731513319811.png)

Sin embargo, es necesario configurar Visual Studio Code para que use Prettier como formateador de c칩digo por defecto. Para ello, abre el archivo de configuraci칩n de Visual Studio Code escribiendo `Ctrl + ,` si est치s en Windows o `Cmd + ,` si est치s en macOS o con la ruta `Archivo > Preferencias > Configuraci칩n` para Windows o `Code > Preferencias > Configuraci칩n` para macOS.

Acontinuaci칩n, selecciona la pesta침a `Workspace` o `츼rea de trabajo` y busca la configuraci칩n `Format On Save`. Aseg칰rate de que la casilla est칠 marcada.

Por 칰ltimo, busca la configuraci칩n `Default Formatter` y selecciona `Prettier - Code formatter`. Esto har치 que Visual Studio Code a침ada una carpeta `.vscode` en la ra칤z del proyecto con un archivo `settings.json` que contiene la configuraci칩n de Prettier para el proyecto. De esa manera el equipo de desarrollo seguir치 el mismo estilo de codificaci칩n.

##### .vscode/settings.json

```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode"
}
```

#### Implementando el archivo `.prettierignore`

El archivo `.prettierignore` es un archivo que le dice a Prettier qu칠 archivos o carpetas debe ignorar al formatear el c칩digo. Por ejemplo, si tienes archivos de configuraci칩n, archivos de prueba o incluso los de distribuci칩n que no quieres formatear, puedes a침adirlos al archivo `.prettierignore`.

Crea un archivo llamado `.prettierignore` en la ra칤z del proyecto con el siguiente contenido:

```plaintext
# Ignorar la carpeta dist
dist/

# Ignorar build
build/
```

Por cierto, la carpeta `node_modules/` est치 ignorada por defecto en Prettier, por lo que no es necesario a침adirla al archivo `.prettierignore`.

### Configurando ESLint

Si bien Prettier se encarga de formatear el c칩digo autom치ticamente, ESLint se encarga de analizar el c칩digo en busca de errores y malas pr치cticas. ESLint es una herramienta muy potente que te permite personalizar las reglas de codificaci칩n seg칰n tus necesidades, aunque sinceramente recomiendo usar un paquete de reglas ya existente como `eslint-config-airbnb` o `eslint-config-standard` ya que son en teor칤a convenciones de codificaci칩n que han sido probadas y son utilizadas por la comunidad.

Por defecto a la fecha Octubre 2024, Vite en su versi칩n 5.4.9 crea un archivo llamado `eslint.config.js` con una configuraci칩n b치sica de ESLint. Sin embargo, vamos a modificarlo de la siguiente manera:

```javascript
import js from "@eslint/js";
import tsEslint from "@typescript-eslint/eslint-plugin";
import tsParser from "@typescript-eslint/parser";
import prettierConfig from "eslint-config-prettier";
import jsxA11y from "eslint-plugin-jsx-a11y";
import reactHooks from "eslint-plugin-react-hooks";
import reactRefresh from "eslint-plugin-react-refresh";
import globals from "globals";

export default [
  {
    ignores: ["dist", "node_modules"], // Archivos y carpetas ignorados
    files: ["**/*.{ts,tsx,js,jsx}"], // Archivos a lint
    languageOptions: {
      ecmaVersion: "latest", // Versi칩n de ECMAScript m치s reciente
      sourceType: "module", // M칩dulos ES
      globals: globals.browser, // Soporte para los globales del navegador
      parser: tsParser, // Parser para TypeScript
    },
    linterOptions: {
      reportUnusedDisableDirectives: true, // Detecta directivas deshabilitadas no usadas
    },
    plugins: {
      "react-hooks": reactHooks, // Plugin para React Hooks
      "react-refresh": reactRefresh, // Plugin para React Refresh
      "@typescript-eslint": tsEslint, // Plugin para TypeScript
      "jsx-a11y": jsxA11y, // Plugin para accesibilidad en JSX
    },
    rules: {
      ...js.configs.recommended.rules, // Reglas recomendadas de JavaScript
      ...tsEslint.configs.recommended.rules, // Reglas recomendadas de TypeScript
      ...reactHooks.configs.recommended.rules, // Reglas recomendadas de React Hooks
      "react-refresh/only-export-components": [
        "warn",
        { allowConstantExport: true },
      ],
      "@typescript-eslint/no-unused-vars": "warn", // Advertencia para variables no usadas en TypeScript
      "jsx-a11y/no-static-element-interactions": "warn", // Accesibilidad para interacciones de elementos est치ticos
    },
  },
  prettierConfig, // Configuraci칩n de Prettier a침adida directamente
];
```

La configuraci칩n propuesta es bastante s칩lida y sigue pr치cticas modernas para proyectos de React con TypeScript utilizando ESLint. Vamos a justificar algunas de las decisiones tomadas:

La configuraci칩n que propones es bastante s칩lida y sigue pr치cticas modernas para proyectos de **React con TypeScript** utilizando ESLint. Aqu칤 te dejo un an치lisis de cada aspecto y algunos ajustes menores que podr칤an optimizarla a칰n m치s:

#### 1. **Uso de plugins**

- **React Hooks y React Refresh**: Estamos utilizando los plugins correctos para optimizar el comportamiento de React Hooks y asegurar la actualizaci칩n r치pida con React Refresh. Estos son esenciales para una experiencia de desarrollo r치pida en entornos de React.
- **TypeScript**: Usar `@typescript-eslint/eslint-plugin` junto con `@typescript-eslint/parser` es la forma correcta de integrar TypeScript en ESLint.
- **Accesibilidad (`jsx-a11y`)**: Incluir `eslint-plugin-jsx-a11y` es una excelente pr치ctica para asegurar que tu aplicaci칩n React siga buenas pr치cticas de accesibilidad.

#### 2. **Soporte para Prettier**

- Incluir `eslint-config-prettier` al final del arreglo es lo correcto. Esto asegura que las reglas de estilo y formato de Prettier no entren en conflicto con las reglas de ESLint, permitiendo que Prettier maneje el formato del c칩digo y ESLint se centre en la calidad del c칩digo.

#### 3. **Ignorar archivos**

- **`ignores: ['dist', 'node_modules']`**: Este uso de `ignores` es correcto y moderno, ya que `.eslintignore` ha sido reemplazado por la propiedad `ignores` en las configuraciones planas.

#### 4. **Configuraci칩n de reglas**

- **Recomendadas**: Se ha configurado correctamente las reglas recomendadas de JavaScript, TypeScript y React Hooks.
- **Reglas personalizadas**: Las reglas personalizadas como `'@typescript-eslint/no-unused-vars': 'warn'` est치n bien configuradas para evitar que las variables no usadas rompan la compilaci칩n, pero sigan mostrando advertencias. Tambi칠n, se a침adi칩 reglas para la accesibilidad (`'jsx-a11y/no-static-element-interactions': 'warn'`) es una excelente opci칩n para garantizar que los componentes cumplan con los est치ndares de accesibilidad.

### Probando la configuraci칩n de ESLint y Prettier

Para probar la configuraci칩n de ESLint y Prettier, bastar치 con ejecutar el siguiente comando:

`ESLint`

```bash
pnpm eslint './src/**/*.{ts,tsx,js,jsx}' --fix
```

`Prettier`

```bash
pnpm prettier --write .
```

Si todo est치 configurado correctamente, ESLint y Prettier formatear치n y analizar치n tu c칩digo sin errores. Si hay errores, ESLint y Prettier te mostrar치n mensajes de error en la consola y te indicar치n c칩mo solucionarlos.

### A침adiendo scripts de ESLint y Prettier al `package.json`

Para facilitar el uso de ESLint y Prettier, a침adiremos scripts al archivo `package.json` que nos permitir치n ejecutar ESLint y Prettier con un solo comando.

```json
{
  "scripts": {
    "lint": "pnpm eslint './src/**/*.{ts,tsx,js,jsx}' --fix",
    "format": "pnpm prettier --write ."
  }
}
```

Despu칠s de a침adir los scripts, ahora tenemos que asegurarnos de que estos se ejecuten antes de crear un commit que ser칤a el paso previo a enviar el c칩digo a nuestro repositorio remoto y posteriormente a producci칩n. Para ello, vamos a instalar la dependencia `husky` que nos permitir치 ejecutar scripts antes de realizar un commit.

## Configurando Husky para ejecutar ESLint y Prettier antes de hacer un commit

Husky es una herramienta que te permite ejecutar scripts antes de realizar un commit en Git. Esto es 칰til para asegurarte de que tu c칩digo cumple con las reglas de ESLint y Prettier antes de enviarlo a tu repositorio remoto.

Para evitar accidentes, podemos configurar `Husky` y `lint-staged`, que se ejecutan antes de confirmar nuestro c칩digo en Git y garantizan que Prettier y ESLint se ejecuten correctamente en el c칩digo fuente antes de confirmarlo.

### Inicializar git en el proyecto

Ya que estamos usando Vite, este bundle no inicializa un repositorio git por defecto, por lo que debemos hacerlo manualmente. Para ello, ejecuta el siguiente comando:

```bash
git init
```

### Instalar Husky y lint-staged

Vamos a instalar las dependencias necesarias:

```bash
pnpm install --save-dev husky lint-staged
```

### Configurar Husky y lint-staged

Abre el archivo `package.json` y a침ade las siguientes configuraciones:

```json
{
  "lint-staged": {
    "*.ts": ["eslint --fix", "prettier --write"],
    "*.tsx": ["eslint --fix", "prettier --write"]
  }
}
```

Esta configuraci칩n le dice a `lint-staged` que ejecute ESLint y Prettier en los archivos `.ts` y `.tsx` antes de confirmarlos en Git.

> Nota: Como puedes ver, estamos separando los archivos `.ts` y `.tsx` para darle m치s flexibilidad y granularidad a la configuraci칩n. Puedes a침adir m치s extensiones de archivos si lo necesitas. Esto nos permitir치 la posibilidad de aplicar reglas espec칤ficas y diferentes para cada tipo de archivo. Sin embargo, si deseas aplicar las mismas reglas a todos los archivos, puedes usar `*.{ts,tsx}`.

#### Inicializar Husky

Para inicializar Husky, ejecuta el siguiente comando:

```bash
pnpm exec husky init
```

> Nota: el comando `pnpm exec` ejecuta un comando en el contexto de un paquete, en este caso, `husky`. Puedes consultar los comandos disponibles en la [documentaci칩n oficial de Husky](https://typicode.github.io/husky/get-started.html) si est치s usando npm o yarn.

El comando anterior crear치 un archivo llamado `.husky/pre-commit` en la ra칤z del proyecto con el siguiente contenido:

```bash
pnpm test
```

Este comando ejecutar치 los tests antes de confirmar el c칩digo en Git. Sin embargo, vamos a modificarlo para que ejecute ESLint y Prettier en su lugar.

#### Modificar el archivo `.husky/pre-commit`

Abre el archivo `.husky/pre-commit` y modif칤calo de la siguiente manera:

```bash
npx lint-staged
```

Este script ejecutar치 `lint-staged` antes de confirmar el c칩digo en Git. `lint-staged` ejecutar치 ESLint y Prettier en los archivos `.ts` y `.tsx` antes de confirmarlos.

#### Asegurarse de que Husky se instale cuando se clone el repositorio

Ya que es probable que en un proyecto real se clone el repositorio en diferentes m치quinas, es importante que Husky se instale autom치ticamente en cada m치quina. Para ello, a침ade el siguiente script al archivo `package.json`:

```json
{
  "scripts": {
    "prepare": "husky install"
  }
}
```

## Bonus: Configurando una convenci칩n de commits con Commitlint

Commitlint es una herramienta que te permite configurar una convenci칩n de commits en tu proyecto. Esto es 칰til para asegurarte de que todos los commits sigan un formato espec칤fico y sean f치ciles de leer.

### Instalar Commitlint

Vamos a instalar las dependencias necesarias:

```bash
pnpm add --save-dev @commitlint/{cli,config-conventional}
```

Luego crear un archivo llamado `commitlint.config.js` en la ra칤z del proyecto usando el siguiente comando:

```bash
echo "export default { extends: ['@commitlint/config-conventional'] };" > commitlint.config.js
```

Esto crear치 un archivo `commitlint.config.js` con la configuraci칩n de Commitlint con el siguiente contenido:

```javascript
export default { extends: ["@commitlint/config-conventional"] };
```

### Configurar Husky para ejecutar Commitlint antes de hacer un commit

Ahora toca configurar Husky para que ejecute Commitlint antes de hacer un commit. Para ello, crearemos un hook llamdo `commit-msg` que se ejecutar치 antes de confirmar el mensaje del commit. Usaremos el siguiente comando para crear el hook:

```bash
echo "npx --no -- commitlint --edit \$1" > .husky/commit-msg
```

Este comando crear un archivo `.husky/commit-msg` en la ra칤z del proyecto con el siguiente contenido:

```bash
npx --no -- commitlint --edit $1
```

Este script ejecutar치 Commitlint antes de confirmar el mensaje del commit en Git. Commitlint comprobar치 que el mensaje del commit siga la convenci칩n de commits configurada en el archivo `commitlint.config.js`.

> Nota: Esta configuraci칩n est치 disponible para la version 9 de Husky, si est치s usando una versi칩n anterior, puedes consultar la [documentaci칩n oficial de Husky](https://typicode.github.io/husky/get-started.html) para obtener m치s informaci칩n.

### Convenci칩n de commits

La convenci칩n de commits que estamos utilizando es la convenci칩n convencional de Angular. Esta convenci칩n es muy popular y es utilizada por muchas empresas y proyectos de c칩digo abierto. A continuaci칩n mencionaremos algunos ejemplos de commits que siguen esta convenci칩n:

- `feat`: Nueva funcionalidad.
- `fix`: Correcci칩n de errores.
- `docs`: Cambios en la documentaci칩n.
- `style`: Cambios que no afectan el c칩digo (espacios en blanco, formato, etc.).
- `refactor`: Cambios en el c칩digo que no corrigen errores ni a침aden funcionalidades.
- `perf`: Cambios en el c칩digo que mejoran el rendimiento.
- `test`: A침adir o modificar pruebas.
- `chore`: Cambios en el proceso de construcci칩n o herramientas auxiliares y bibliotecas.
- `revert`: Revertir un commit anterior.
- `ci`: Cambios en la configuraci칩n de CI/CD.
- `build`: Cambios en la configuraci칩n de construcci칩n.

Si intentamos hacer un commit que no siga esta convenci칩n, Commitlint nos mostrar치 un mensaje de error y no nos permitir치 confirmar el c칩digo en Git como se muestra en la siguiente imagen:

![1731513358941](image/7ee9d46e796ce9/1731513358941.png)

Para corregir el error, simplemente debemos seguir la convenci칩n de commits y volver a intentar hacer el commit.

```bash
git commit -m "docs: document for the project"
```

## Conclusiones

En este art칤culo, hemos aprendido c칩mo configurar un proyecto de React para producci칩n utilizando las mejores pr치cticas. Hemos configurado Prettier y ESLint para aplicar las mejores pr치cticas de codificaci칩n, Husky y lint-staged para ejecutar ESLint y Prettier antes de hacer un commit, y Commitlint para configurar una convenci칩n de commits en nuestro proyecto.

Espero que este art칤culo te haya sido 칰til y te haya ayudado a configurar tu proyecto de React para producci칩n. Si tienes alguna pregunta o sugerencia, no dudes en dejar un comentario.
