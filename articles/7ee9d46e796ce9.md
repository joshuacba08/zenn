---
title: "Configurando un proyecto de React para producci√≥n"
emoji: "ü¶Å"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics:
  ["React", "Vite", "TypeScript", "ESLint", "Prettier", "Husky", "Commitlint"]
published: true
---

# Configurando un proyecto de React para producci√≥n

## Introducci√≥n

Internet est√° lleno de tutoriales sobre c√≥mo iniciar un proyecto web con React, sin embargo la mayor√≠a de estos tutoriales son para proyectos peque√±os o de prueba. En este tutorial, aprender√°s c√≥mo las empresas reales configuran sus proyectos de React para producci√≥n utilizando las mejores pr√°cticas.

## Requerimientos t√©cnicos

Para seguir este art√≠culo, necesitar√°s tener instalado las siguientes tecnolog√≠as:

- Node.js V20.10.0 o superior
- Git v2.43.0 o superior
- Visual Studio Code v1.94.0 o superior
- pnpm

Estas son las versiones que he utilizado para escribir este art√≠culo, pero es posible que funcione con versiones anteriores no muy antiguas o superiores.

## ¬øPor qu√© pnpm?

Quiz√°s la t√≠pica frase que oir√°s decir a la mayor√≠a de los desarrolladores que usamos pnpm es: "pnpm es m√°s r√°pido que npm y yarn". Pero en mi experiencia trabajando en la industria, la raz√≥n m√°s importante para usar pnpm es que este instala las dependencias de forma plana, lo que significa que no instala m√∫ltiples versiones de la misma dependencia. Esto ahorra espacio en disco y reduce el tiempo de instalaci√≥n de las dependencias. Adem√°s, evita problemas de compatibilidad entre las dependencias.

## Creando un nuevo proyecto con Vite

Vite es un nuevo bundler que ha ganado mucha popularidad en la comunidad de React. Vite es mucho m√°s r√°pido que Create React App y es compatible con TypeScript de forma nativa. Para crear un nuevo proyecto con Vite, simplemente ejecuta el siguiente comando:

```bash
pnpm create vite
```

Veremos las siguientes opciones:

- **Project name**: Nombre del proyecto, para este caso, el proyecto se llamar√° `react-real-world`.
- **Select a framework**: Selecciona React.
- **Select a variant**: Selecciona React con TypeScript.

Una vez que hayas seleccionado todas las opciones, Vite crear√° un nuevo proyecto de React con TypeScript.

Acto seguido, ejecuta los siguientes comandos para instalar las dependencias necesarias:

```bash
cd react-real-world
pnpm install
```

Tambi√©n abriremos el proyecto en Visual Studio Code:

```bash
code .
```

## React con SWC o Babel

Vite es compatible con SWC y Babel. SWC es un compilador de JavaScript extremadamente r√°pido que es compatible con la mayor√≠a de las caracter√≠sticas de Babel. Sin embargo, Babel es m√°s popular y tiene una comunidad m√°s grande.

En lineas generales, los par√°metros m√°s importantes para elegir entre SWC y Babel son:

- **Velocidad**: SWC es mucho m√°s r√°pido que Babel.
- **Compatibilidad**: Babel es m√°s compatible con las √∫ltimas caracter√≠sticas de JavaScript.
- **Comunidad**: Babel tiene una comunidad m√°s grande y es m√°s popular.

Si tu aplicaci√≥n ser√° muy grande y compleja y necesitas una velocidad de compilaci√≥n muy r√°pida en producci√≥n, te recomiendo que uses SWC. Si tu aplicaci√≥n es peque√±a o mediana y necesitas una compatibilidad m√°xima con las √∫ltimas caracter√≠sticas de JavaScript, te recomiendo que uses Babel.

En todo caso, ser√≠a mejor iniciar el proyecto con babel, osea no seleccionar SWC en la creaci√≥n del proyecto, y luego cambiar a SWC si es necesario, los pasos para hacerlo son muy sencillos.

## Configurando ESLint y Prettier con TypeScript para aplicar las mejores pr√°cticas

Ahora que hemos creado nuestro proyecto de React con TypeScript, es hora de configurar ESLint y Prettier para aplicar las mejores pr√°cticas de codificaci√≥n. Para ello justificaremos ambas herramientas cuando las estemos configurando.

Antes que nada vamos a instalar las dependencias necesarias:

```bash
pnpm install --save-dev prettier eslint eslint-plugin-react eslint-config-prettier eslint-plugin-jsx-a11y @typescript-eslint/parser @typescript-eslint/eslint-plugin
```

Pnpm instalar√° lo siguiente:

- **prettier**: Herramienta de formateo de c√≥digo.
- **eslint**: Herramienta de an√°lisis de c√≥digo.
- **eslint-plugin-react**: Plugin de ESLint para React.
- **eslint-config-prettier**: Desactiva las reglas de ESLint que pueden entrar en conflicto con Prettier.
- **eslint-plugin-jsx-a11y**: Plugin de ESLint para accesibilidad en JSX.
- **@typescript-eslint/parser**: Parser de TypeScript para ESLint.
- **@typescript-eslint/eslint-plugin**: Plugin de ESLint para TypeScript.

> El comando `--save-dev` instala las dependencias como dependencias de desarrollo, lo que significa que no se instalar√°n en producci√≥n. Esto es obligatorio ya que de lo contrario las dependencias se instalar√°n en producci√≥n y aumentar√°n el tama√±o de la aplicaci√≥n.

### Configurando Prettier

Prettier es una herramienta de formateo de c√≥digo que te permite formatear tu c√≥digo autom√°ticamente. La motivaci√≥n detr√°s de Prettier es que no deber√≠as perder tiempo formateando tu c√≥digo manualmente, sino que deber√≠as dejar que Prettier lo haga por ti autom√°ticamente. De esta forma, todos los miembros del equipo de desarrollo seguir√°n el mismo estilo de codificaci√≥n.

Para configurar Prettier, crearemos un archivo llamdo `.prettierrc.json` en la ra√≠z del proyecto con el siguiente contenido:

```json
{
  "trailingComma": "all",
  "tabWidth": 2,
  "printWidth": 80,
  "semi": false,
  "singleQuote": true,
  "jsxSingleQuote": true
}
```

#### Configurando la extensi√≥n de Prettier en Visual Studio Code

Para que Visual Studio Code formatee autom√°ticamente tu c√≥digo con Prettier, necesitas instalar la extensi√≥n de Prettier. Para ello, abre Visual Studio Code y busca la extensi√≥n de Prettier en el Marketplace. Una vez que la hayas instalado, Visual Studio Code formatear√° autom√°ticamente tu c√≥digo con Prettier cada vez que guardes un archivo.

![1731513319811](image/7ee9d46e796ce9/1731513319811.png)

Sin embargo, es necesario configurar Visual Studio Code para que use Prettier como formateador de c√≥digo por defecto. Para ello, abre el archivo de configuraci√≥n de Visual Studio Code escribiendo `Ctrl + ,` si est√°s en Windows o `Cmd + ,` si est√°s en macOS o con la ruta `Archivo > Preferencias > Configuraci√≥n` para Windows o `Code > Preferencias > Configuraci√≥n` para macOS.

Acontinuaci√≥n, selecciona la pesta√±a `Workspace` o `√Årea de trabajo` y busca la configuraci√≥n `Format On Save`. Aseg√∫rate de que la casilla est√© marcada.

Por √∫ltimo, busca la configuraci√≥n `Default Formatter` y selecciona `Prettier - Code formatter`. Esto har√° que Visual Studio Code a√±ada una carpeta `.vscode` en la ra√≠z del proyecto con un archivo `settings.json` que contiene la configuraci√≥n de Prettier para el proyecto. De esa manera el equipo de desarrollo seguir√° el mismo estilo de codificaci√≥n.

##### .vscode/settings.json

```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode"
}
```

#### Implementando el archivo `.prettierignore`

El archivo `.prettierignore` es un archivo que le dice a Prettier qu√© archivos o carpetas debe ignorar al formatear el c√≥digo. Por ejemplo, si tienes archivos de configuraci√≥n, archivos de prueba o incluso los de distribuci√≥n que no quieres formatear, puedes a√±adirlos al archivo `.prettierignore`.

Crea un archivo llamado `.prettierignore` en la ra√≠z del proyecto con el siguiente contenido:

```plaintext
# Ignorar la carpeta dist
dist/

# Ignorar build
build/
```

Por cierto, la carpeta `node_modules/` est√° ignorada por defecto en Prettier, por lo que no es necesario a√±adirla al archivo `.prettierignore`.

### Configurando ESLint

Si bien Prettier se encarga de formatear el c√≥digo autom√°ticamente, ESLint se encarga de analizar el c√≥digo en busca de errores y malas pr√°cticas. ESLint es una herramienta muy potente que te permite personalizar las reglas de codificaci√≥n seg√∫n tus necesidades, aunque sinceramente recomiendo usar un paquete de reglas ya existente como `eslint-config-airbnb` o `eslint-config-standard` ya que son en teor√≠a convenciones de codificaci√≥n que han sido probadas y son utilizadas por la comunidad.

Por defecto a la fecha Octubre 2024, Vite en su versi√≥n 5.4.9 crea un archivo llamado `eslint.config.js` con una configuraci√≥n b√°sica de ESLint. Sin embargo, vamos a modificarlo de la siguiente manera:

```javascript
import js from "@eslint/js";
import tsEslint from "@typescript-eslint/eslint-plugin";
import tsParser from "@typescript-eslint/parser";
import prettierConfig from "eslint-config-prettier";
import jsxA11y from "eslint-plugin-jsx-a11y";
import reactHooks from "eslint-plugin-react-hooks";
import reactRefresh from "eslint-plugin-react-refresh";
import globals from "globals";

export default [
  {
    ignores: ["dist", "node_modules"], // Archivos y carpetas ignorados
    files: ["**/*.{ts,tsx,js,jsx}"], // Archivos a lint
    languageOptions: {
      ecmaVersion: "latest", // Versi√≥n de ECMAScript m√°s reciente
      sourceType: "module", // M√≥dulos ES
      globals: globals.browser, // Soporte para los globales del navegador
      parser: tsParser, // Parser para TypeScript
    },
    linterOptions: {
      reportUnusedDisableDirectives: true, // Detecta directivas deshabilitadas no usadas
    },
    plugins: {
      "react-hooks": reactHooks, // Plugin para React Hooks
      "react-refresh": reactRefresh, // Plugin para React Refresh
      "@typescript-eslint": tsEslint, // Plugin para TypeScript
      "jsx-a11y": jsxA11y, // Plugin para accesibilidad en JSX
    },
    rules: {
      ...js.configs.recommended.rules, // Reglas recomendadas de JavaScript
      ...tsEslint.configs.recommended.rules, // Reglas recomendadas de TypeScript
      ...reactHooks.configs.recommended.rules, // Reglas recomendadas de React Hooks
      "react-refresh/only-export-components": [
        "warn",
        { allowConstantExport: true },
      ],
      "@typescript-eslint/no-unused-vars": "warn", // Advertencia para variables no usadas en TypeScript
      "jsx-a11y/no-static-element-interactions": "warn", // Accesibilidad para interacciones de elementos est√°ticos
    },
  },
  prettierConfig, // Configuraci√≥n de Prettier a√±adida directamente
];
```

La configuraci√≥n propuesta es bastante s√≥lida y sigue pr√°cticas modernas para proyectos de React con TypeScript utilizando ESLint. Vamos a justificar algunas de las decisiones tomadas:

La configuraci√≥n que propones es bastante s√≥lida y sigue pr√°cticas modernas para proyectos de **React con TypeScript** utilizando ESLint. Aqu√≠ te dejo un an√°lisis de cada aspecto y algunos ajustes menores que podr√≠an optimizarla a√∫n m√°s:

#### 1. **Uso de plugins**

- **React Hooks y React Refresh**: Estamos utilizando los plugins correctos para optimizar el comportamiento de React Hooks y asegurar la actualizaci√≥n r√°pida con React Refresh. Estos son esenciales para una experiencia de desarrollo r√°pida en entornos de React.
- **TypeScript**: Usar `@typescript-eslint/eslint-plugin` junto con `@typescript-eslint/parser` es la forma correcta de integrar TypeScript en ESLint.
- **Accesibilidad (`jsx-a11y`)**: Incluir `eslint-plugin-jsx-a11y` es una excelente pr√°ctica para asegurar que tu aplicaci√≥n React siga buenas pr√°cticas de accesibilidad.

#### 2. **Soporte para Prettier**

- Incluir `eslint-config-prettier` al final del arreglo es lo correcto. Esto asegura que las reglas de estilo y formato de Prettier no entren en conflicto con las reglas de ESLint, permitiendo que Prettier maneje el formato del c√≥digo y ESLint se centre en la calidad del c√≥digo.

#### 3. **Ignorar archivos**

- **`ignores: ['dist', 'node_modules']`**: Este uso de `ignores` es correcto y moderno, ya que `.eslintignore` ha sido reemplazado por la propiedad `ignores` en las configuraciones planas.

#### 4. **Configuraci√≥n de reglas**

- **Recomendadas**: Se ha configurado correctamente las reglas recomendadas de JavaScript, TypeScript y React Hooks.
- **Reglas personalizadas**: Las reglas personalizadas como `'@typescript-eslint/no-unused-vars': 'warn'` est√°n bien configuradas para evitar que las variables no usadas rompan la compilaci√≥n, pero sigan mostrando advertencias. Tambi√©n, se a√±adi√≥ reglas para la accesibilidad (`'jsx-a11y/no-static-element-interactions': 'warn'`) es una excelente opci√≥n para garantizar que los componentes cumplan con los est√°ndares de accesibilidad.

### Probando la configuraci√≥n de ESLint y Prettier

Para probar la configuraci√≥n de ESLint y Prettier, bastar√° con ejecutar el siguiente comando:

`ESLint`

```bash
pnpm eslint './src/**/*.{ts,tsx,js,jsx}' --fix
```

`Prettier`

```bash
pnpm prettier --write .
```

Si todo est√° configurado correctamente, ESLint y Prettier formatear√°n y analizar√°n tu c√≥digo sin errores. Si hay errores, ESLint y Prettier te mostrar√°n mensajes de error en la consola y te indicar√°n c√≥mo solucionarlos.

### A√±adiendo scripts de ESLint y Prettier al `package.json`

Para facilitar el uso de ESLint y Prettier, a√±adiremos scripts al archivo `package.json` que nos permitir√°n ejecutar ESLint y Prettier con un solo comando.

```json
{
  "scripts": {
    "lint": "pnpm eslint './src/**/*.{ts,tsx,js,jsx}' --fix",
    "format": "pnpm prettier --write ."
  }
}
```

Despu√©s de a√±adir los scripts, ahora tenemos que asegurarnos de que estos se ejecuten antes de crear un commit que ser√≠a el paso previo a enviar el c√≥digo a nuestro repositorio remoto y posteriormente a producci√≥n. Para ello, vamos a instalar la dependencia `husky` que nos permitir√° ejecutar scripts antes de realizar un commit.

## Configurando Husky para ejecutar ESLint y Prettier antes de hacer un commit

Husky es una herramienta que te permite ejecutar scripts antes de realizar un commit en Git. Esto es √∫til para asegurarte de que tu c√≥digo cumple con las reglas de ESLint y Prettier antes de enviarlo a tu repositorio remoto.

Para evitar accidentes, podemos configurar `Husky` y `lint-staged`, que se ejecutan antes de confirmar nuestro c√≥digo en Git y garantizan que Prettier y ESLint se ejecuten correctamente en el c√≥digo fuente antes de confirmarlo.

### Inicializar git en el proyecto

Ya que estamos usando Vite, este bundle no inicializa un repositorio git por defecto, por lo que debemos hacerlo manualmente. Para ello, ejecuta el siguiente comando:

```bash
git init
```

### Instalar Husky y lint-staged

Vamos a instalar las dependencias necesarias:

```bash
pnpm install --save-dev husky lint-staged
```

### Configurar Husky y lint-staged

Abre el archivo `package.json` y a√±ade las siguientes configuraciones:

```json
{
  "lint-staged": {
    "*.ts": ["eslint --fix", "prettier --write"],
    "*.tsx": ["eslint --fix", "prettier --write"]
  }
}
```

Esta configuraci√≥n le dice a `lint-staged` que ejecute ESLint y Prettier en los archivos `.ts` y `.tsx` antes de confirmarlos en Git.

> Nota: Como puedes ver, estamos separando los archivos `.ts` y `.tsx` para darle m√°s flexibilidad y granularidad a la configuraci√≥n. Puedes a√±adir m√°s extensiones de archivos si lo necesitas. Esto nos permitir√° la posibilidad de aplicar reglas espec√≠ficas y diferentes para cada tipo de archivo. Sin embargo, si deseas aplicar las mismas reglas a todos los archivos, puedes usar `*.{ts,tsx}`.

#### Inicializar Husky

Para inicializar Husky, ejecuta el siguiente comando:

```bash
pnpm exec husky init
```

> Nota: el comando `pnpm exec` ejecuta un comando en el contexto de un paquete, en este caso, `husky`. Puedes consultar los comandos disponibles en la [documentaci√≥n oficial de Husky](https://typicode.github.io/husky/get-started.html) si est√°s usando npm o yarn.

El comando anterior crear√° un archivo llamado `.husky/pre-commit` en la ra√≠z del proyecto con el siguiente contenido:

```bash
pnpm test
```

Este comando ejecutar√° los tests antes de confirmar el c√≥digo en Git. Sin embargo, vamos a modificarlo para que ejecute ESLint y Prettier en su lugar.

#### Modificar el archivo `.husky/pre-commit`

Abre el archivo `.husky/pre-commit` y modif√≠calo de la siguiente manera:

```bash
npx lint-staged
```

Este script ejecutar√° `lint-staged` antes de confirmar el c√≥digo en Git. `lint-staged` ejecutar√° ESLint y Prettier en los archivos `.ts` y `.tsx` antes de confirmarlos.

#### Asegurarse de que Husky se instale cuando se clone el repositorio

Ya que es probable que en un proyecto real se clone el repositorio en diferentes m√°quinas, es importante que Husky se instale autom√°ticamente en cada m√°quina. Para ello, a√±ade el siguiente script al archivo `package.json`:

```json
{
  "scripts": {
    "prepare": "husky install"
  }
}
```

## Bonus: Configurando una convenci√≥n de commits con Commitlint

Commitlint es una herramienta que te permite configurar una convenci√≥n de commits en tu proyecto. Esto es √∫til para asegurarte de que todos los commits sigan un formato espec√≠fico y sean f√°ciles de leer.

### Instalar Commitlint

Vamos a instalar las dependencias necesarias:

```bash
pnpm add --save-dev @commitlint/{cli,config-conventional}
```

Luego crear un archivo llamado `commitlint.config.js` en la ra√≠z del proyecto usando el siguiente comando:

```bash
echo "export default { extends: ['@commitlint/config-conventional'] };" > commitlint.config.js
```

Esto crear√° un archivo `commitlint.config.js` con la configuraci√≥n de Commitlint con el siguiente contenido:

```javascript
export default { extends: ["@commitlint/config-conventional"] };
```

### Configurar Husky para ejecutar Commitlint antes de hacer un commit

Ahora toca configurar Husky para que ejecute Commitlint antes de hacer un commit. Para ello, crearemos un hook llamdo `commit-msg` que se ejecutar√° antes de confirmar el mensaje del commit. Usaremos el siguiente comando para crear el hook:

```bash
echo "npx --no -- commitlint --edit \$1" > .husky/commit-msg
```

Este comando crear un archivo `.husky/commit-msg` en la ra√≠z del proyecto con el siguiente contenido:

```bash
npx --no -- commitlint --edit $1
```

Este script ejecutar√° Commitlint antes de confirmar el mensaje del commit en Git. Commitlint comprobar√° que el mensaje del commit siga la convenci√≥n de commits configurada en el archivo `commitlint.config.js`.

> Nota: Esta configuraci√≥n est√° disponible para la version 9 de Husky, si est√°s usando una versi√≥n anterior, puedes consultar la [documentaci√≥n oficial de Husky](https://typicode.github.io/husky/get-started.html) para obtener m√°s informaci√≥n.

### Convenci√≥n de commits

La convenci√≥n de commits que estamos utilizando es la convenci√≥n convencional de Angular. Esta convenci√≥n es muy popular y es utilizada por muchas empresas y proyectos de c√≥digo abierto. A continuaci√≥n mencionaremos algunos ejemplos de commits que siguen esta convenci√≥n:

- `feat`: Nueva funcionalidad.
- `fix`: Correcci√≥n de errores.
- `docs`: Cambios en la documentaci√≥n.
- `style`: Cambios que no afectan el c√≥digo (espacios en blanco, formato, etc.).
- `refactor`: Cambios en el c√≥digo que no corrigen errores ni a√±aden funcionalidades.
- `perf`: Cambios en el c√≥digo que mejoran el rendimiento.
- `test`: A√±adir o modificar pruebas.
- `chore`: Cambios en el proceso de construcci√≥n o herramientas auxiliares y bibliotecas.
- `revert`: Revertir un commit anterior.
- `ci`: Cambios en la configuraci√≥n de CI/CD.
- `build`: Cambios en la configuraci√≥n de construcci√≥n.

Si intentamos hacer un commit que no siga esta convenci√≥n, Commitlint nos mostrar√° un mensaje de error y no nos permitir√° confirmar el c√≥digo en Git como se muestra en la siguiente imagen:

![1731513358941](image/7ee9d46e796ce9/1731513358941.png)

Para corregir el error, simplemente debemos seguir la convenci√≥n de commits y volver a intentar hacer el commit.

```bash
git commit -m "docs: document for the project"
```

## Conclusiones

En este art√≠culo, hemos aprendido c√≥mo configurar un proyecto de React para producci√≥n utilizando las mejores pr√°cticas. Hemos configurado Prettier y ESLint para aplicar las mejores pr√°cticas de codificaci√≥n, Husky y lint-staged para ejecutar ESLint y Prettier antes de hacer un commit, y Commitlint para configurar una convenci√≥n de commits en nuestro proyecto.

Espero que este art√≠culo te haya sido √∫til y te haya ayudado a configurar tu proyecto de React para producci√≥n. Si tienes alguna pregunta o sugerencia, no dudes en dejar un comentario.
